html(ng-app='nitApp')
  head
    meta(charset='utf-8')
    link(rel='stylesheet', href='//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css')
    link(rel='stylesheet', href='//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css')
    link(rel='stylesheet', href='/vendor.css')
    link(rel='stylesheet', href='/app.css')

  body(ng-controller='AdminController', ng-init='testt="#{title}"')
    #top-bar
      div
        p Velkommen til Trondheim!

    #container
      header
        h1(style='color: #fff; margin-top: 50px') #{title}

      section
        .row
          .col-xs-3.admin-article-sidebar
            .row
              ul#admin-article-list
                li.new-article-li(ng-click='createArticle()', ng-class='{"selected-article": selectedIndex==0}') Ny artikkel
                li.article-li(ng-repeat='article in articles',
                  ng-click='chooseArticle(article, $index + 1)',
                  ng-class='{"selected-article": selectedIndex==($index+1)}') {{article.title}}
            .row
              ul#admin-event-list
                li.new-event-li(ng-click='createEvent()', ng-class='{"selected-article": selectedIndex==articles.length}') Nytt arrangement
                li.event-li(ng-repeat='event in events',
                  ng-click='chooseArticle(event, $index + articles.length + 1)',
                  ng-class='{"selected-event": selectedIndex==($index+1+articles.length)}') {{event.title}}

          .col-xs-9.admin-article-main

            form(name='articleForm', role='form')
              .form-group(ng-class='{"has-warning": articleForm.title.$invalid, "has-success": articleForm.title.$valid}')
                label(for='title') Tittel
                input.form-control#title(type='text', name='title', placeholder='Tittel',
                                         value='{{article.title}}', ng-model='article.title' required)
              .form-group(ng-class='{"has-warning": articleForm.priority.$invalid, "has-success": articleForm.priority.$valid}')
                label(for='priority') Prioritet
                select.form-control#priority(name='priority', ng-options='option for option in priorities',
                                             ng-model='article.priority' required)
              .form-group(ng-class='{"has-warning": articleForm.description.$invalid, "has-success": articleForm.description.$valid}')
                label(for='description') Beskrivelse
                textarea.form-control#description(rows='2', name='description', placeholder='Beskrivelse',
                                                  ng-model='article.description' required)='{{article.description}}'
              .form-group(ng-class='{"has-warning": articleForm.body.$invalid, "has-success": articleForm.body.$valid}')
                label(for='body') Tekst
                textarea.form-control#text-body(rows='5', name='body', placeholder='Tekst',
                                                ng-model='article.body' required)='{{article.body}}'

              div(ng-switch='article.event')
                div(ng-switch-when='true')
                  .form-group(ng-class='{"has-warning": articleForm.location.$invalid, "has-success": articleForm.location.$valid}')
                    label(for='body') Sted
                    textarea.form-control#text-body(rows='5', name='location', placeholder='Sted',
                                                    ng-model='article.location' required)='{{article.location}}'
                  .row
                    .col-md-6
                      label Dato
                    .col-md-6
                      label Tidspunkt
                  .row
                    .col-md-6
                      .form-group(ng-class='{"has-warning": articleForm.startDate.$invalid, "has-success": articleForm.startDate.$valid}')
                        .input-group
                          input.form-control(name='startDate', type='text', is-open='$parent.opened1', datepicker-popup='dd/MM/yyyy', ng-model='article.start', min='today', required)
                          span.input-group-btn
                            button.btn.btn-default(type='button', ng-click='open($event, "opened1")') Startdato
                    .col-md-6
                      .form-group(ng-class='{"has-warning": articleForm.startTime.$invalid, "has-error": articleForm.startTime.$error.pattern, "has-success": !articleForm.startTime.$error.pattern && articleForm.startTime.$valid}')
                        .input-group
                          input.form-control(name='startTime', ng-model='article.startTime',
                            ng-pattern='/^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/' placeholder='Starttidspunkt (hh:mm)',
                            ng-class='{"has-error": articleForm.startTime.$error.pattern}', required)
                          span.input-group-addon Starttidspunkt
                  .row
                    .col-md-6
                      .form-group(ng-class='{"has-warning": articleForm.endDate.$invalid, "has-success": articleForm.endDate.$valid}')
                        .input-group
                          input.form-control(name='endDate', type='text', is-open='$parent.opened2', datepicker-popup='dd/MM/yyyy', ng-model='article.end', min='today', required)
                          span.input-group-btn
                            button.btn.btn-default(type='button', ng-click='open($event, "opened2")') Sluttdato
                    .col-md-6
                      .form-group(ng-class='{"has-warning": articleForm.endTime.$invalid, "has-error": articleForm.endTime.$error.pattern, "has-success": !articleForm.endTime.$error.pattern && articleForm.endTime.$valid}')
                        .input-group
                          input.form-control(name='endTime', ng-model='article.endTime',
                            ng-pattern='/^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/' placeholder='Sluttidspunkt (hh:mm)',
                            required)
                          span.input-group-addon Sluttidspunkt&nbsp;&nbsp;

              div(ng-switch='articleForm.$valid')
                div(ng-switch-when='true')
                  button.btn.btn-primary(ng-click='saveArticle(article)', ng-hide='article._id') Send
                  .btn-group(ng-hide='!article._id')
                    button.btn.btn-primary(ng-click='saveArticle(article)') Send
                    button.btn.btn-danger(ng-click='destroyArticle(article)') Slett
                div(ng-switch-default)
                  button.btn.btn-primary.disabled(ng-click='saveArticle(article)', ng-hide='article._id') Fyll inn all feltene!
                  .btn-group(ng-hide='!article._id')
                    button.btn.btn-primary.disabled(ng-click='saveArticle(article)') Fyll inn alle feltene!
                    button.btn.btn-danger(ng-click='destroyArticle(article)') Slett

    script.
      union = !{JSON.stringify(union)}
    script(src='/vendor.js')
    script(src='/app.js')
